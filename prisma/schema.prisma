generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String     @id @default(cuid())
  name      String     @unique
  email     String?    @unique
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  checkIns  CheckIn[]
  createdLocations Location[] // New relation to track created temporary locations

  @@map("users")
}

model Location {
  id          String     @id @default(cuid())
  name        String
  description String
  icon        String     // Icon name from lucide-react
  color       String     // Tailwind color class
  isActive    Boolean    @default(true)
  isTemporary Boolean    @default(false) // New field for temporary locations
  createdBy   String?    // New field to track who created the temporary location
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  checkIns    CheckIn[]

  // Add relation to User for temporary locations
  creator     User?      @relation(fields: [createdBy], references: [id], onDelete: SetNull)

  @@map("locations")
}

model CheckIn {
  id         String    @id @default(cuid())
  userId     String
  locationId String
  checkedInAt DateTime @default(now())
  checkedOutAt DateTime?
  isActive   Boolean   @default(true)
  
  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  location   Location  @relation(fields: [locationId], references: [id], onDelete: Cascade)

  @@map("checkins")
  @@index([userId])
  @@index([locationId])
  @@index([isActive])
} 